<div class="modal-overlay" (click)="closeModal()">

  <div class="modal-card" (click)="$event.stopPropagation()">

    <header class="modal-header">
      <h2>Nova Categoria</h2>
      <button class="close-button" (click)="closeModal()">×</button>
    </header>

    <div class="modal-body">
      <form [formGroup]="categoryForm" (ngSubmit)="onSubmit()">

        <div class="form-group">
          <label for="nome">Nome da Categoria</label>
          <input type="text"
                 id="nome"
                 formControlName="nome"
                 class="input-field"
                 placeholder="Ex: Pintura Digital"
                 required>
          <div *ngIf="f['nome'].touched && f['nome'].errors" class="error-message-inline">
            <span *ngIf="f['nome'].errors?.['required']">O nome é obrigatório.</span>
            <span *ngIf="f['nome'].errors?.['maxlength']">Máximo de 100 caracteres.</span>
          </div>
        </div>

        <div class="form-group">
          <label for="descricao">Descrição (Opcional)</label>
          <textarea id="descricao"
                    formControlName="descricao"
                    class="textarea-field"
                    rows="3"
                    placeholder="Descreva brevemente a categoria..."></textarea>
          <div *ngIf="f['descricao'].touched && f['descricao'].errors" class="error-message-inline">
            <span *ngIf="f['descricao'].errors?.['maxlength']">Máximo de 500 caracteres.</span>
          </div>
        </div>

        <div *ngIf="errorMessage" class="error-message general-error">
          {{ errorMessage }}
        </div>

        <footer class="modal-actions">
          <button type="button" class="btn btn-secondary" (click)="closeModal()">
            Cancelar
          </button>
          <button type="submit" class="btn btn-primary" [disabled]="categoryForm.invalid || isLoading">
            <span *ngIf="!isLoading">Criar Categoria</span>
            <span *ngIf="isLoading">A criar...</span>
          </button>
        </footer>

      </form>
    </div>

    <div *ngIf="isLoading" class="loading-overlay">
      <div class="spinner"></div>
    </div>

  </div>
</div>